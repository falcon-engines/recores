<!-- {{/*

    FUNCTION : GET CSS AND JS FILES

    syntax : {{ partial "get-script" ( dict "ctx" . "type" "[style|script]" "load" "[head|foot]" ) }}
    attrib :
        - ctx  : page context paramater variable, do not change/remove `ctx` parameters !
        - type : type script you want to get ( style | script ).
        - load : target script your want to get ( head | foot )
    example:
        {{- $styles_head := partial "get-script" ( dict "ctx" . "type" "style" "load" "head" ) -}}

*/}} -->

<!-- function variable -->

{{ $type := .type }}
{{ $load := .load }}
{{ $data := slice }}
{{ $link := slice }}
{{ $exts := "" }}
{{ $hook := "" }}


<!-- define in use hook -->
{{ if and ( eq $type "style" ) ( eq $load "head" ) }}
    {{- $hook = "head_styles_register" -}}
{{ else if and ( eq $type "script" ) ( eq $load "head" ) }}
    {{- $hook = "head_script_register" -}}
{{ else if and ( eq $type "style" ) ( eq $load "foot" )  }}
    {{- $hook = "foot_styles_register" -}}
{{ else if and ( eq $type "script" ) ( eq $load "foot" ) }}
    {{- $hook = "foot_script_register" -}}
{{ end }}


<!-- extract script and concatination -->
{{ range ( .ctx.Page.Scratch.Get $hook )  }}

    {{ if eq ( path.Ext . ) ".scss" }}
        {{ $link = $link | append ( resources.Get . )  }}
        {{ $exts = "sccs" }}
    {{ end }}

    
    {{ if eq ( path.Ext . ) ".js" }}
    
        {{ $link = $link | append ( resources.Get . )  }}
        {{ $exts = "js" }}
    {{ end }}
{{ end }}


<!-- data finishing -->
{{ if eq hugo.IsProduction false }}

    {{ if eq $exts "sccs" }}
        {{ $data = $link | resources.Concat ( print "css/" $load ".css" ) | toCSS }}
    {{ end }}


    {{ if eq $exts "js" }}
        {{ $data = $link | resources.Concat ( print "js/" $load ".js" ) | js.Build ( dict "targetPath" ( print "js/" $load ".js") )  }}
    {{ end }}

{{ else  }}

    {{ if eq $exts "sccs" }}
        {{ $data = $link | resources.Concat ( print "css/" $load ".css" ) | toCSS | minify | fingerprint }}
    {{ end }}


    {{ if eq $exts "js" }}
        {{ $data = $link | resources.Concat ( print "js/" $load ".js" ) |  js.Build ( dict "targetPath" ( print "js/" $load ".js") ) | minify | fingerprint }}
    {{ end }}

{{ end }}


{{- return $data -}}