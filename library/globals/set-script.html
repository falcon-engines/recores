<!-- {{/*

    FUNCTION : REGISTER JS AND CSS FILES

    syntax : {{ partial "set-scripts" ( dict "ctx" . "link" "[file url]" "load" "[render target]" "cond" "[page store set parameter]" ) }}
    attrib :
        - link : parse current page context to this function, do not change/remove `ctx` parameters !
        - link : url of js / css file
        - load : ( head | foot )
        - cond : .Page.Store.Set parameter name, value type from .Page.Store.Set function parameter must be boelean.  
                 Empty cond attribute on register-script function make scss/js file will render on entire site pages.
    example:
        {{ partial "register-script" ( dict "ctx" . "link" "scss/base.css" "load" "head" "cond" "" ) }}
        {{ partial "register-script" ( dict "ctx" . "link" "jsx/audio.js"  "load" "foot" "cond" "begin_audio_element" ) }}

*/}} -->


<!-- function variable -->
{{ $link := resources.Get .link }}
{{ $exts := path.Ext .link }}
{{ $path := "" }}


{{ if and 
    ( strings.Contains $link "based" ) 
    ( strings.Contains $link "head" ) }}


    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}

        {{ $assets := resources.Get $link | toCSS }}
        {{- .ctx.Page.Scratch.Add "based_head_styles" ( slice $assets ) -}}
    {{ end }}
    
    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "based_head_script" ( slice $link ) -}}
    {{ end }}


{{ else if and 
    ( strings.Contains .link  "based" ) 
    ( strings.Contains .link  "foot" ) }}


    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}
        {{- .ctx.Page.Scratch.Add "based_foot_style" ( slice $link ) -}}
    {{ end }}
    
    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "based_foot_script" ( slice $link ) -}}
    {{ end }}


{{ else if and 
    ( strings.Contains .link  "blocks" )
    ( strings.Contains .link  "head" ) }}

    
    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}
        {{- .ctx.Page.Scratch.Add "block_foot_style" ( slice $link ) -}}
    {{ end }}

    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "block_foot_script" ( slice $link ) -}}
    {{ end }}


{{ else if and 
    ( strings.Contains .link  "blocks" )
    ( strings.Contains .link  "foot" ) }}

    
    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}
        {{- .ctx.Page.Scratch.Add "block_foot_style" ( slice $link ) -}}
    {{ end }}

    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "block_foot_script" ( slice $link ) -}}
    {{ end }}


{{ else if and 
    ( strings.Contains .link  "paged" ) 
    ( strings.Contains .link  "head" ) }}


    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}
        {{- .ctx.Page.Scratch.Add "paged_head_style" ( slice $link ) -}}
    {{ end }}
    
    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "paged_head_script" ( slice $link ) -}}
    {{ end }}


{{ else if and 
    ( strings.Contains .link  "paged" )
    ( strings.Contains .link  "foot" ) }}


    {{ if or ( eq $exts ".scss" ) ( eq $exts ".less" ) ( eq $exts ".sass" ) ( eq $exts ".css" ) }}
        {{- .ctx.Page.Scratch.Add "paged_foot_style" ( slice $link ) -}}
    {{ end }}

    {{ if or ( eq $exts ".js" ) ( eq $exts ".ts" )  }}
        {{- .ctx.Page.Scratch.Add "paged_foot_script" ( slice $link ) -}}
    {{ end }}


{{ end }}