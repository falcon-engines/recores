<!-- {{/*

    FUNCTION : REGISTER JS AND CSS FILES

    syntax : {{ partial "set-scripts" ( dict "ctx" . "link" "[file url]" "load" "[render target]" "cond" "[page store set parameter]" ) }}
    attrib :
        - link : parse current page context to this function, do not change/remove `ctx` parameters !
        - link : url of js / css file
        - load : ( head | foot )
        - cond : .Page.Store.Set parameter name, value type from .Page.Store.Set function parameter must be boelean.  
                 Empty cond attribute on register-script function make scss/js file will render on entire site pages.
    example:
        {{ partial "register-script" ( dict "ctx" . "link" "scss/base.css" "load" "head" "cond" "" ) }}
        {{ partial "register-script" ( dict "ctx" . "link" "jsx/audio.js"  "load" "foot" "cond" "begin_audio_element" ) }}

*/}} -->


<!-- function variable -->

{{ $link := .link }}
{{ $load := .load }}
{{ $cond := .cond }}
{{ $exts := path.Ext .link }}
{{ $type := cond ( eq $exts ".js" ) "script" "styles" }}
{{ $hook := print $load "_" $type "_register" }}


{{ if eq ( and ( or ( eq $exts ".scss" ) ( eq $exts ".js" )) ( or ( eq $load "head" ) ( eq $load "foot" )) ) false  }}
    
    <!-- error file format  -->
    {{  if eq ( or ( eq $exts ".scss" ) ( eq $exts ".js" ) ) false }}
        {{ print "Error : format " $link " not supported." }}
    {{ end }}

    <!-- error target load  -->
    {{ if eq ( or ( eq $load "head" ) ( eq $load "foot" ) ) false }}
        {{ print "Error : Target render " $load " not supported ." }}
    {{ end }}

{{ else if ( gt ( len $cond ) 0 ) }}

    <!-- register script based on params  -->
    {{ if eq ( .ctx.Page.Store.Get $cond ) true }}
        {{- .ctx.Page.Scratch.Add $hook ( slice .link ) -}}
    {{ end }}
    
{{ else  }}

    <!-- register script  -->
    {{- .ctx.Page.Scratch.Add $hook ( slice .link ) -}}

{{ end }}

