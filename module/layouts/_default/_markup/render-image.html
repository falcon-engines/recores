<!-- GLOBAL -->
{{- $getlink := .Destination | safeURL }}
{{- $pathsrc := .Page.Resources.GetMatch $getlink }}
{{- $stylerc := "lazy-load flex-c" }}
{{- $srctype := "" }}


<!-- RENDER -->
{{- if or ( strings.Contains $getlink "png" ) ( strings.Contains $getlink "webp" ) ( strings.Contains $getlink "jpeg" ) ( strings.Contains $getlink "jpg" ) ( strings.Contains $getlink "svg" ) -}}

    <!-- render image -->
    {{ if strings.Contains $getlink "http" }}
        {{ $pathsrc = $getlink }}
    {{ else if $pathsrc }}
        {{ $pathsrc = $pathsrc }}
    {{ else if resources.GetMatch ( print "images/" $getlink ) }}
        {{ $pathsrc = resources.GetMatch ( print "images/" $getlink ) }}
    {{ else }}
        {{ $pathsrc = "/icons/no-image.svg" }}
    {{ end }}

    <div class="flex-c">
        {{- $resizer := slice "320" "640" "960" "1280" "1680" "1972"  -}}
        {{- $mediawd := "(min-width: 1024px) 100vw, 50vw" -}}
        {{- $normals := $pathsrc.Resize "640x jpg" -}}
        <figure class="fluid">
            <picture>
                
                {{ $getwebp := slice }}
                {{ range $resizer }}
                    {{ $value  :=  print ($pathsrc.Resize (printf "%sx%s" . " webp") ).RelPermalink " " . "w" }}
                    {{ $getwebp = $getwebp | append $value }} 
                {{ end }}
                {{ $webpsrc := delimit $getwebp ", "  }}
                <source type="image/webp" srcset=" {{- print $webpsrc -}}" sizes="{{ $mediawd }}" />
                
                {{ $getjpg := slice }}
                {{ range $resizer }}
                    {{ $value :=  print ($pathsrc.Resize (printf "%sx%s" . " jpg") ).RelPermalink " " . "w" }}
                    {{ $getwebp = $getwebp | append $value }} 
                {{ end }}
                {{ $jpgsrc  := delimit $getjpg ", "  }}
                <source type="image/jpg"  srcset=" {{- print $jpgsrc -}}" sizes="{{ $mediawd }}" />
                <img src="{{ $normals }}" class="fluid"  alt="{{ .Title }}" loading="lazy">
            </picture>
            {{ with .Text }}<p class="fw-600 caption" data-alt="{{ . }}">{{ . }}</p>{{ end }}
        </figure>
    </div>


{{- else if or ( strings.Contains $getlink "mp4" ) ( strings.Contains $getlink "flv" ) ( strings.Contains $getlink "avi" ) ( strings.Contains $getlink "mkv" )  }}
    
    <!-- render video -->
    {{ if strings.Contains $getlink "http" }}
        {{ $pathsrc = $getlink }}
    {{ else if $pathsrc }}
        {{ $pathsrc = $pathsrc }}
    {{ else if resources.GetMatch ( print "/videos/" $getlink ) }}
        {{ $pathsrc = resources.GetMatch ( print "/videos/" $getlink ) }}
    {{ else }}
        {{ $pathsrc = "/icons/no-image.svg" }}
    {{ end }}

    <div class="media landscape grid align-a colfix" data-src="{{ $pathsrc.RelPermalink }}" data-type="video" data-cover="{{ .Title }}">
        <div class="loader-round">
            <div></div><div></div>
        </div>
    </div>


{{- else if strings.Contains $getlink ".pdf" -}}

    <!-- render pdf -->
    {{ if strings.Contains $getlink "http" }}
        {{ $pathsrc = $getlink }}
    {{ else if $pathsrc }}
        {{ $pathsrc = $pathsrc }}
    {{ else if ( where ( readDir "assets/docus/" ) "Name" $getlink ) }}
        {{ $pathsrc = print "/docus/" $getlink }}
    {{ else }}
        {{ $pathsrc = "/icons/no-image.svg" }}
    {{ end }}
   
    <div class="media portrait grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="file">
        <div class="loader-round"><div></div><div></div></div>
    </div>


{{- else if strings.Contains $getlink "youtube.com"  }}

    <!-- youtube embed -->
    {{ $pathsrc = strings.Replace $getlink "watch?v=" "embed/" }}

    <div class="media landscape grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="youtube">
        <div class="loader-round"><div></div><div></div></div>
    </div>

{{- else if strings.Contains $getlink "vimeo.com"  }}

    <!-- vimeo embed -->
    {{ $pathsrc = $getlink }}

    <div class="media landscape grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="vimeo">
        <div class="loader-round"><div></div><div></div></div>
    </div>

{{- else if strings.Contains $getlink "docs.google.com/document" }}

    <!-- google document embed -->
    {{ $pathsrc = print $getlink "?embedded=true" }}

    <div class="media portrait grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="gdoc">
        <div class="loader-round"><div></div><div></div></div>
    </div>
   
{{- else if strings.Contains $getlink "docs.google.com/spreadsheets"  -}}

    <!-- google spreadsheets embed -->
    {{ if strings.Contains $getlink "gid=" }}
        {{ $pathsrc = print $getlink "&widget=true&headers=false" }}
    {{ else }}
        {{ $pathsrc = print $getlink "?widget=true&headers=false" }}
    {{ end }}

    <div class="media portrait grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="gxls">
        <div class="loader-round"><div></div><div></div></div>
    </div>
   

{{- else if strings.Contains $getlink "docs.google.com/presentation"  -}}

    <!-- google presentation embed -->
    {{ $pathsrc = replace $getlink "pub?" "embed?" }}

    <div class="media landscape grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="gppt">
        <div class="loader-round"><div></div><div></div></div>
    </div>

{{- else if strings.Contains $getlink "drive.google.com/file" -}}

    <!-- google pdf embed -->
    {{ $pathsrc = replace $getlink "/view?usp=share_link" "/preview" }}

    <div class="media portrait grid align-a colfix" data-src="{{ $pathsrc }}" data-title="{{ .Text }}" data-type="gpdf">
        <div class="loader-round"><div></div><div></div></div>
    </div>


{{- else if strings.Contains $getlink "lottie" -}}

    <!-- lottie animation embed -->
    {{ if strings.Contains $getlink "http" }}
        {{ $pathsrc = $getlink }}
    {{ else if resources.GetMatch ( print "anima/" $getlink ) }}
        {{ $pathsrc = resources.GetMatch ( print "anima/" $getlink ) }}
    {{ else }}
        {{ $pathsrc = "/icons/no-image.svg" }}
    {{ end }}

    <div class="animax grid align-a colfix" data-type="animax">
        <dotlottie-player src="{{ $pathsrc.RelPermalink }}" background="transparent" speed="1" direction="1" mode="normal" loop autoplay></dotlottie-player>
    </div>

{{ end }}