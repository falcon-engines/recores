{{- $resizer := slice "420" "640" "768" "960" "1280" "1536" -}}
{{- $globsrc := resources.GetMatch ( print "images/" .Destination ) }}
{{- $pagesrc := .Page.Resources.GetMatch .Destination }}
{{- $pathsrc := "" }}
{{- $stylerc := "lazy-load flex-c round-10" }}
{{- $imgsize := "100vw" -}}

<!-- image sources -->
{{ if $globsrc }} 
    {{ $pathsrc = $globsrc }}
{{ else if $pagesrc }}
    {{ $pathsrc = $pagesrc }}
{{ else }}
    {{ $pathsrc = "/icons/no-image.svg" }}
    {{ $stylerc = "lazy-load flex-c round-10 noimg" }}
{{ end }}


<!-- image processing -->

{{ $resizeact := "" }}
{{ $resizedxs := "" }}
{{ $resizedsm := "" }}
{{ $resizedmd := "" }}
{{ $resizedlg := "" }}
{{ $resizedxl := "" }}
{{ $resizedx2 := "" }}

{{ if ne $pathsrc "/icons/no-image.svg" }}

    <!-- image resizers 420 -->

    {{- if ge $pathsrc.Width 420 -}} 
        {{ $resizedxs = $pathsrc.Resize "420x"  }}
        {{ $resizeact = $resizedxs }}
    {{ end }}


    <!-- image resizers 640 -->
   
    {{- if ge $pathsrc.Width 640 -}}
        {{ $resizedsm = $pathsrc.Resize "640x"  }}
        {{ $resizeact = $resizedsm }}
    {{ end }}


    <!-- image resizers 768 -->
   
    {{- if ge $pathsrc.Width 768 -}}
        {{ $resizedmd = $pathsrc.Resize "768x"  }}
        {{ $resizeact = $resizedmd }}
    {{ end }}


    <!-- image resizers 960 -->

    {{- if ge $pathsrc.Width 960 -}}
        {{ $resizedlg = $pathsrc.Resize "960x"  }}
        {{ $resizeact = $resizedlg }}
    {{ end }}


    <!-- image resizers 1280 -->

    {{- if ge $pathsrc.Width 1280 -}}
        {{ $resizedxl = $pathsrc.Resize "1280x"  }}
        {{ $resizeact = $resizedxl }}
    {{ end }}


    <!-- image resizers 1536 -->
    {{- if ge $pathsrc.Width 1536 -}}
        {{ $resizedx2 = $pathsrc.Resize "1536x"  }}
        {{ $resizeact = $pathsrc }}
    {{ end }}


    {{- if ge $pathsrc.Width 1800 -}}
        {{ $resizeact = $pathsrc }}
    {{ end }}

{{ end }}

<!-- render images -->
<div class=" {{ $stylerc }}">
    <figure>
        <picture>
            {{ if $resizedxs }}
            <source media="(max-width: 420px)"  srcset="{{ $resizedxs.RelPermalink }}">
            {{ end }}
            {{ if $resizedsm }}
            <source media="(max-width: 640px)"  srcset="{{ $resizedsm.RelPermalink }}">
            {{ end }}
            {{ if $resizedmd }}
            <source media="(max-width: 768px)"  srcset="{{ $resizedmd.RelPermalink }}">
            {{ end }}
            {{ if $resizedlg }}
            <source media="(max-width: 960px)"  srcset="{{ $resizedlg.RelPermalink }}">
            {{ end }}
            {{ if $resizedxl }}
            <source media="(max-width: 1280px)" srcset="{{ $resizedxl.RelPermalink }}">
            {{ end }}
            {{ if $resizedx2 }}
            <source media="(max-width: 1536px)" srcset="{{ $resizedx2.RelPermalink }}">
            {{ end }}
            <source media="(min-width: 1536px)" srcset="{{ $resizeact }}">

            
            <img src="{{ $pathsrc }}" class="image round-10" alt="{{ .Title }}" loading="lazy">
        </picture>
        <p class="fw-600 caption" data-alt="{{ .Text }}">No image</p>
    </figure>
</div>
